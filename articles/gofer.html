<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Building a GOfER with 'ggplot2' and 'patchwork' • metabolic</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Building a GOfER with 'ggplot2' and 'patchwork'">
<meta property="og:description" content="metabolic">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-126092763-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-126092763-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">metabolic</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/metabolic.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Datasets</li>
    <li>
      <a href="../articles/metabolic_meta.html">
        <span class="fa fa-database"></span>
         
        metabolic_meta
      </a>
    </li>
    <li>
      <a href="../articles/metabolic_gofer.html">
        <span class="fa fa-database"></span>
         
        metabolic_gofer
      </a>
    </li>
    <li class="divider">
    <li>
      <a href="../articles/gofer.html">
        <span class="fa fa-wrench"></span>
         
        Building a GOfER with 'ggplot2' and 'patchwork'
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-balance-scale"></span>
     
    Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-newspaper"></span>
     
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/fmmattioni/metabolic">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://twitter.com/felipe_mattioni">
    <span class="fa fa-twitter fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="gofer_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Building a GOfER with ‘ggplot2’ and ‘patchwork’</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/fmmattioni/metabolic/blob/master/vignettes/gofer.Rmd"><code>vignettes/gofer.Rmd</code></a></small>
      <div class="hidden name"><code>gofer.Rmd</code></div>

    </div>

    
    
<p>I first found out about the GOfER diagram (Graphical Overview for Evidence Reviews) in this tweet from <a href="https://twitter.com/will_s_t">Will Stahl-Timmins</a>:</p>
<blockquote class="twitter-tweet" align="center">
<p lang="en" dir="ltr">
The BMJ's first ever GOfER diagram (Graphical Overview for Evidence Reviews) today, in this systematic review of the effects of eating breakfast on weight loss: <a href="https://t.co/OlHIQ5mtwd">https://t.co/OlHIQ5mtwd</a> <a href="https://twitter.com/hashtag/BMJInfographic?src=hash&amp;ref_src=twsrc%5Etfw">#BMJInfographic</a> <a href="https://t.co/3jIDvEYOAJ">pic.twitter.com/3jIDvEYOAJ</a>
</p>
— Will Stahl-Timmins (<span class="citation">@will_s_t</span>) <a href="https://twitter.com/will_s_t/status/1090937361251385344?ref_src=twsrc%5Etfw">January 31, 2019</a>
</blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script><p>I was quite impressed with this diagram. It was the perfect replacement for the rather boring “Table 1” in meta-analyses. So I decided that I wanted to have something similar to my meta-analysis paper. Because, why not? A little bit of googling got me to this <a href="http://blogs.exeter.ac.uk/gofer/">website</a>. This is the software that Will developed from his thesis. The software is quite nice and with a quick read in its manual, you have your first GOfER. There was one problem for me, though. I had a rather large amount of data, and the software doesn’t support copy and pasting functionality. Therefore, if I had to add or change things around it was a quite tedious work. Therefore, I contacted Will to check whether I could understand a little better how the data is handle by the software in the background. I wanted to develop a way I could prepare the data in <strong>R</strong> and then perhaps exported it as a <strong>.json</strong> file and voilá!</p>
<p>In the meantime I was writing Will (it was around December of 2019), <a href="https://twitter.com/thomasp85">Thomas Lin Pedersen</a> was preparing a CRAN release for the awesome <a href="https://patchwork.data-imaginist.com/">{patchwork}</a> R package. When I saw <a href="https://patchwork.data-imaginist.com/articles/guides/layout.html#cb9">this vignette</a> was when I realized: <strong>I can make a GOfER entirely in R using ggplot2 and patchwork!!!!</strong> This layout functionality was the perfect feature that I needed to make it work the way I thought it could be done!</p>
<p>After two days of work, this is the result that you now see in the paper:</p>
<p><img src="img/gofer_page_1.png" style="width:100.0%"></p>
<div class="rmdinfo">
<p>
You can of course read the source code to check how it is done, but I am going to also walk you through here to explain a little better, so you can also build one if you want.
</p>
</div>
<div id="steps-to-build-a-gofer" class="section level2">
<h2 class="hasAnchor">
<a href="#steps-to-build-a-gofer" class="anchor"></a>Steps to build a GOfER</h2>
<div id="prepare-your-data" class="section level3">
<h3 class="hasAnchor">
<a href="#prepare-your-data" class="anchor"></a>1) Prepare your data</h3>
<p>Please, take a look at <code>metabolic_gofer</code> to see the data structure being used in to build the GOfER.</p>
<p>Your first step should be to define in how many pages you want to display your information, given the amount of details from each study you want to provide. For this vignette, we are going to make an example with <strong>10 studies</strong>, but our original GOfER had <strong>28 studies</strong> in one page. Therefore, the first step is to filter these data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://github.com/fmmattioni/metabolic">metabolic</a></span>)

<span class="kw">data_gofer</span> <span class="op">&lt;-</span> <span class="kw">metabolic_gofer</span> <span class="op">%&gt;%</span> 
  <span class="co">## arrange study and groups to show in the correct order in the graph</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span>(<span class="kw">study</span>), <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span>(<span class="kw">groups</span>)) <span class="op">%&gt;%</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(study = <span class="kw">forcats</span>::<span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span>(<span class="kw">study</span>)) <span class="op">%&gt;%</span>
  <span class="kw">tidyr</span>::<span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest_legacy.html">nest_legacy</a></span>(<span class="op">-</span><span class="kw">study</span>) <span class="op">%&gt;%</span> 
  <span class="co">## get the first 10 studies</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">tail</a></span>(<span class="fl">10</span>)

<span class="co">## here we get the number of studies + 1 to show the lines in the graph</span>
<span class="co">## since we have 10 studies, this is simply 10 + 1</span>
<span class="kw">n_lines</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="op">+</span> <span class="fl">1</span>

<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="kw">data_gofer</span>, n = <span class="fl">Inf</span>)
<span class="co">#&gt; # A tibble: 10 x 2</span>
<span class="co">#&gt;    study            data             </span>
<span class="co">#&gt;    &lt;fct&gt;            &lt;list&gt;           </span>
<span class="co">#&gt;  1 Eguchi 2012      &lt;tibble [2 × 32]&gt;</span>
<span class="co">#&gt;  2 Earnest 2013     &lt;tibble [2 × 32]&gt;</span>
<span class="co">#&gt;  3 Currie 2015      &lt;tibble [2 × 32]&gt;</span>
<span class="co">#&gt;  4 Conraads 2015    &lt;tibble [2 × 32]&gt;</span>
<span class="co">#&gt;  5 Cocks 2013       &lt;tibble [2 × 32]&gt;</span>
<span class="co">#&gt;  6 Ciolac 2010      &lt;tibble [2 × 32]&gt;</span>
<span class="co">#&gt;  7 Burgomaster 2008 &lt;tibble [2 × 32]&gt;</span>
<span class="co">#&gt;  8 Beetham 2019     &lt;tibble [2 × 32]&gt;</span>
<span class="co">#&gt;  9 Bækkerud 2016    &lt;tibble [2 × 32]&gt;</span>
<span class="co">#&gt; 10 Abdelbasset 2020 &lt;tibble [2 × 32]&gt;</span>
</pre></div>
</div>
<div id="before-we-begin-plotting" class="section level3">
<h3 class="hasAnchor">
<a href="#before-we-begin-plotting" class="anchor"></a>Before we begin plotting…</h3>
<p>I am going to set a new <code>ggplot2</code> theme. Here we are setting common settings for a theme that we are going to use in every plot. Some settings differ depending if the plot has only text or if there is line plot, for example.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://patchwork.data-imaginist.com">patchwork</a></span>)
</pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">theme_gofer</span> <span class="op">&lt;-</span> <span class="fu">function</span>(<span class="kw">strip_background</span> = <span class="st">"#1f58b5"</span>, <span class="kw">margins</span> = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>), <span class="kw">line_plot</span> = <span class="fl">FALSE</span>) {
  <span class="co">if</span>(<span class="kw">line_plot</span>) {
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span>() <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(
        panel.grid.major = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(size = <span class="fl">0.5</span>, linetype = <span class="st">'solid'</span>, colour = <span class="st">"black"</span>),
        panel.grid.minor = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
        axis.text.y = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(size = <span class="fl">8</span>),
        panel.background = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
        panel.border = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
        plot.background = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
        plot.margin = <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span>(<span class="kw">margins</span>, <span class="st">"cm"</span>),
        axis.title.y = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
        strip.background = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span>(fill = <span class="kw">strip_background</span>),
        strip.text = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(size = <span class="fl">15</span>, colour = <span class="st">"white"</span>),
        legend.position = <span class="st">"none"</span>
      )
  } <span class="co">else</span> {
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_light</a></span>() <span class="op">+</span>
      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(
        panel.background = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
        panel.border = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
        panel.grid = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
        plot.background = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
        plot.margin = <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span>(<span class="kw">margins</span>, <span class="st">"cm"</span>),
        axis.title = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
        axis.text = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
        axis.ticks = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),
        strip.background = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_rect</a></span>(fill = <span class="kw">strip_background</span>),
        strip.text = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(size = <span class="fl">15</span>, colour = <span class="st">"white"</span>),
        legend.position = <span class="st">"none"</span>
      )
  }
}
</pre></div>
</div>
<div id="build-the-lines-to-separate-the-studies---the-basic-grid-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#build-the-lines-to-separate-the-studies---the-basic-grid-plot" class="anchor"></a>2) Build the lines to separate the studies - the basic grid plot</h3>
<p>For the plot, the first step is to build the basic grid, which is the lines that will separate each study.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">
<span class="kw">p_grid</span> <span class="op">&lt;-</span> <span class="kw">data_gofer</span> <span class="op">%&gt;%</span> 
  <span class="co"># this is a hack to show a white space between the facet and the plot</span>
  <span class="co"># this is needed to be able to have subheadings</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html">add_row</a></span>(study = <span class="fl">NA</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span>
  <span class="co">## here although we do not plot the study labels yet, this is needed to ensure</span>
  <span class="co">## that plots will be aligned across panels since they always share the same x-axis (study)</span>
  <span class="kw">ggfittext</span>::<span class="fu"><a href="https://rdrr.io/pkg/ggfittext/man/geom_fit_text.html">geom_fit_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">study</span>, y = <span class="fl">0</span>, label = <span class="st">""</span>),
                           place = <span class="st">"left"</span>,
                           reflow = <span class="fl">TRUE</span>,
                           fontface = <span class="st">"plain"</span>,
                           position = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span>(width = <span class="fl">0.7</span>),
                           show.legend = <span class="fl">FALSE</span>,
                           na.rm = <span class="fl">TRUE</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span>(xintercept = <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">1</span>, <span class="kw">n_lines</span>, <span class="fl">1</span>)  <span class="op">-</span> <span class="fl">0.5</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span>()

<span class="kw">p_grid</span>
</pre></div>
<p><img src="gofer_files/figure-html/unnamed-chunk-6-1.png" width="2400" style="display: block; margin: auto;"></p>
</div>
<div id="study-panel" class="section level3">
<h3 class="hasAnchor">
<a href="#study-panel" class="anchor"></a>3) Study panel</h3>
<p>Here is when the studies (Author and Year) are plotted. Also, the colorful headers at the top will be created with <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">ggplot2::facet_wrap()</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">p_studies</span> <span class="op">&lt;-</span> <span class="kw">data_gofer</span> <span class="op">%&gt;%</span>
  <span class="co"># this is a hack to show a white space between the facet and the plot</span>
  <span class="co"># this is needed to be able to have subheadings</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html">add_row</a></span>(study = <span class="fl">NA</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span>
  <span class="kw">ggfittext</span>::<span class="fu"><a href="https://rdrr.io/pkg/ggfittext/man/geom_fit_text.html">geom_fit_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">study</span>, y = <span class="fl">0</span>, label = <span class="kw">study</span>),
                           place = <span class="st">"centre"</span>,
                           reflow = <span class="fl">TRUE</span>,
                           fontface = <span class="st">"plain"</span>,
                           show.legend = <span class="fl">FALSE</span>,
                           na.rm = <span class="fl">TRUE</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span> <span class="st">"Study"</span>) <span class="op">+</span>
  <span class="fu">theme_gofer</span>()

<span class="kw">p_studies</span>
</pre></div>
<p><img src="gofer_files/figure-html/unnamed-chunk-7-1.png" width="2400" style="display: block; margin: auto;"></p>
<div class="rmdwarning">
<p>
<br> Current GOfER state - Control layout with <code>patchwork</code>
</p>
</div>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">layout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">1</span>, b = <span class="fl">3</span>, r = <span class="fl">2</span>), <span class="co"># p_grid (the `r` argument will be adjusted as we go.. it controls the width of the plot)</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">1</span>, b = <span class="fl">3</span>, r = <span class="fl">1</span>) <span class="co"># p_studies</span>
)

<span class="kw">p_grid</span> <span class="op">+</span>
  <span class="kw">p_studies</span> <span class="op">+</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span>(nrow = <span class="fl">1</span>, design = <span class="kw">layout</span>)
</pre></div>
<p><img src="gofer_files/figure-html/unnamed-chunk-9-1.png" width="2400" style="display: block; margin: auto;"></p>
</div>
<div id="sample-panel" class="section level3">
<h3 class="hasAnchor">
<a href="#sample-panel" class="anchor"></a>4) Sample panel</h3>
<p>Here we plot general characteristics from the sample of each study, such as <strong>population</strong>, <strong>fitness</strong>, and <strong>men ratio</strong>.</p>
<div id="data-preparation" class="section level4">
<h4 class="hasAnchor">
<a href="#data-preparation" class="anchor"></a>Data preparation</h4>
<p>Here some data preparation is needed to define color of labels and y-axis placement.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="co">## data preparation</span>
<span class="kw">data_sample</span> <span class="op">&lt;-</span> <span class="kw">data_gofer</span> <span class="op">%&gt;%</span>
  <span class="kw">tidyr</span>::<span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest_legacy.html">unnest_legacy</a></span>() <span class="op">%&gt;%</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="kw">study</span>, <span class="kw">dplyr</span>::<span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span>(<span class="st">"sample"</span>)) <span class="op">%&gt;%</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(sample_men_ratio = <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(<span class="kw">sample_men_ratio</span>, digits = <span class="fl">1</span>),
                fill = <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span>(
                  <span class="kw">sample_men_ratio</span> <span class="op">&gt;</span> <span class="fl">0.5</span> <span class="op">~</span> <span class="st">"#355c7d"</span>,
                  <span class="kw">sample_men_ratio</span> <span class="op">==</span> <span class="fl">0.5</span> <span class="op">~</span> <span class="st">"#c06c84"</span>,
                  <span class="kw">sample_men_ratio</span> <span class="op">&lt;</span> <span class="fl">0.5</span> <span class="op">~</span> <span class="st">"#f67280"</span>
                ),
                sample_men_ratio = <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="kw">sample_men_ratio</span>, fmt = <span class="st">'%#.1f'</span>)) <span class="op">%&gt;%</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct_all.html">distinct_all</a></span>() <span class="op">%&gt;%</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span>(<span class="kw">study</span>)) <span class="op">%&gt;%</span>
  <span class="co"># this is a hack to show a white space between the facet and the plot</span>
  <span class="co"># this is needed to be able to have subheadings</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html">add_row</a></span>(study = <span class="fl">NA</span>) <span class="op">%&gt;%</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(
    dummy_population = <span class="fl">0.5</span>,
    dummy_fitness = <span class="fl">2</span>,
    dummy_men_ratio = <span class="fl">3.5</span>
  )

<span class="kw">data_sample</span>
<span class="co">#&gt; # A tibble: 13 x 8</span>
<span class="co">#&gt;    study sample_populati… sample_fitness sample_men_ratio fill  dummy_population</span>
<span class="co">#&gt;    &lt;fct&gt; &lt;chr&gt;            &lt;chr&gt;          &lt;chr&gt;            &lt;chr&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Abde… "T2D"            N/R            0.5              #c06…              0.5</span>
<span class="co">#&gt;  2 Abde… "T2D"            N/R            0.6              #355…              0.5</span>
<span class="co">#&gt;  3 Bækk… "Overweight\nOb… Sedentary      0.4              #f67…              0.5</span>
<span class="co">#&gt;  4 Beet… "Overweight\nOb… Active         0.8              #355…              0.5</span>
<span class="co">#&gt;  5 Beet… "Overweight\nOb… Active         0.7              #355…              0.5</span>
<span class="co">#&gt;  6 Burg… "Healthy"        Sedentary      0.5              #c06…              0.5</span>
<span class="co">#&gt;  7 Ciol… "Healthy"        Sedentary      0.0              #f67…              0.5</span>
<span class="co">#&gt;  8 Cock… "Healthy"        Sedentary      1.0              #355…              0.5</span>
<span class="co">#&gt;  9 Conr… "Cardiac\nRehab" Sedentary      0.9              #355…              0.5</span>
<span class="co">#&gt; 10 Curr… "Cardiac\nRehab" Sedentary      0.9              #355…              0.5</span>
<span class="co">#&gt; 11 Earn… "Overweight\nOb… Sedentary      1.0              #355…              0.5</span>
<span class="co">#&gt; 12 Eguc… "Healthy"        Sedentary      1.0              #355…              0.5</span>
<span class="co">#&gt; 13 &lt;NA&gt;   &lt;NA&gt;            &lt;NA&gt;           &lt;NA&gt;             &lt;NA&gt;               0.5</span>
<span class="co">#&gt; # … with 2 more variables: dummy_fitness &lt;dbl&gt;, dummy_men_ratio &lt;dbl&gt;</span>
</pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">p_sample</span> <span class="op">&lt;-</span> <span class="kw">data_sample</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span>
  <span class="co">## Population</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">study</span>, y = <span class="kw">dummy_population</span>, label = <span class="kw">sample_population</span>),
                     fontface = <span class="st">"plain"</span>,
                     show.legend = <span class="fl">FALSE</span>,
                     na.rm = <span class="fl">TRUE</span>) <span class="op">+</span>
  <span class="co">## Population subheading</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="fl">NA</span>, y = <span class="kw">dummy_population</span>),
                     label = <span class="st">"Population"</span>,
                     size = <span class="fl">5</span>,
                     fontface = <span class="st">"bold"</span>,
                     show.legend = <span class="fl">FALSE</span>,
                     na.rm = <span class="fl">TRUE</span>) <span class="op">+</span>
  <span class="co">## Fitness</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">study</span>, y = <span class="kw">dummy_fitness</span>, label = <span class="kw">sample_fitness</span>),
                     fontface = <span class="st">"plain"</span>,
                     show.legend = <span class="fl">FALSE</span>,
                     na.rm = <span class="fl">TRUE</span>) <span class="op">+</span>
  <span class="co">## Fitness subheading</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="fl">NA</span>, y = <span class="kw">dummy_fitness</span>),
                     label = <span class="st">"Fitness"</span>,
                     size = <span class="fl">5</span>,
                     fontface = <span class="st">"bold"</span>,
                     show.legend = <span class="fl">FALSE</span>,
                     na.rm = <span class="fl">TRUE</span>) <span class="op">+</span>
  <span class="co">## Men Ratio</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_label</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">study</span>, y = <span class="kw">dummy_men_ratio</span>, label = <span class="kw">sample_men_ratio</span>, fill = <span class="kw">fill</span>),
                      colour = <span class="st">"white"</span>,
                      size = <span class="fl">4</span>,
                      fontface = <span class="st">"bold"</span>,
                      na.rm = <span class="fl">TRUE</span>) <span class="op">+</span>
  <span class="co">## Men Ratio subheading</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="fl">NA</span>, y = <span class="kw">dummy_men_ratio</span>),
                     label = <span class="st">"Men\nratio"</span>,
                     size = <span class="fl">5</span>,
                     fontface = <span class="st">"bold"</span>,
                     show.legend = <span class="fl">FALSE</span>,
                     na.rm = <span class="fl">TRUE</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_identity.html">scale_fill_identity</a></span>() <span class="op">+</span>
  <span class="co">## the following will ensure that there is some extra space at the beginning and at the end</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span>(<span class="fl">0</span>, <span class="fl">4</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span> <span class="st">"Sample"</span>) <span class="op">+</span>
  <span class="fu">theme_gofer</span>()

<span class="kw">p_sample</span>
</pre></div>
<p><img src="gofer_files/figure-html/unnamed-chunk-11-1.png" width="2400" style="display: block; margin: auto;"></p>
<div class="rmdwarning">
<p>
<br> Current GOfER state - Control layout with <code>patchwork</code>
</p>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">layout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">1</span>, b = <span class="fl">3</span>, r = <span class="fl">3</span>), <span class="co"># p_grid (the `r` argument will be adjusted as we go.. it controls the width of the plot)</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">1</span>, b = <span class="fl">3</span>, r = <span class="fl">1</span>), <span class="co"># p_studies</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">2</span>, b = <span class="fl">3</span>, r = <span class="fl">3</span>)  <span class="co"># p_sample</span>
)

<span class="kw">p_grid</span> <span class="op">+</span>
  <span class="kw">p_studies</span> <span class="op">+</span>
  <span class="kw">p_sample</span> <span class="op">+</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span>(nrow = <span class="fl">1</span>, design = <span class="kw">layout</span>)
</pre></div>
<p><img src="gofer_files/figure-html/unnamed-chunk-13-1.png" width="2400" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="anamnese-panel" class="section level3">
<h3 class="hasAnchor">
<a href="#anamnese-panel" class="anchor"></a>5) Anamnese panel</h3>
<p>Here we plot information on whether participants in the studies were <strong>smokers</strong> and were taking <strong>medicines to control blood pressure</strong>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="co">## data preparation</span>
<span class="kw">data_anamnese</span> <span class="op">&lt;-</span> <span class="kw">data_gofer</span> <span class="op">%&gt;%</span>
  <span class="kw">tidyr</span>::<span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest_legacy.html">unnest_legacy</a></span>() <span class="op">%&gt;%</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="kw">study</span>, <span class="kw">dplyr</span>::<span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span>(<span class="st">"anamnese"</span>)) <span class="op">%&gt;%</span>
  <span class="co"># this is a hack to show a white space between the facet and the plot</span>
  <span class="co"># this is needed to be able to have subheadings</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html">add_row</a></span>(study = <span class="fl">NA</span>) <span class="op">%&gt;%</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(
    dummy_smoker = <span class="fl">1</span>,
    dummy_medicines = <span class="fl">2</span>
  ) <span class="op">%&gt;%</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct_all.html">distinct_all</a></span>()

<span class="kw">data_anamnese</span>
<span class="co">#&gt; # A tibble: 11 x 5</span>
<span class="co">#&gt;    study      anamnese_smoker anamnese_medicines_t… dummy_smoker dummy_medicines</span>
<span class="co">#&gt;    &lt;fct&gt;      &lt;chr&gt;           &lt;chr&gt;                        &lt;dbl&gt;           &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Eguchi 20… N/R             N/R                              1               2</span>
<span class="co">#&gt;  2 Earnest 2… N/R             N                                1               2</span>
<span class="co">#&gt;  3 Currie 20… N               Y                                1               2</span>
<span class="co">#&gt;  4 Conraads … Y               Y                                1               2</span>
<span class="co">#&gt;  5 Cocks 2013 N/R             N                                1               2</span>
<span class="co">#&gt;  6 Ciolac 20… N               N                                1               2</span>
<span class="co">#&gt;  7 Burgomast… N/R             N                                1               2</span>
<span class="co">#&gt;  8 Beetham 2… N/R             Y                                1               2</span>
<span class="co">#&gt;  9 Bækkerud … N/R             N/R                              1               2</span>
<span class="co">#&gt; 10 Abdelbass… N               N/R                              1               2</span>
<span class="co">#&gt; 11 &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;                             1               2</span>
</pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit">
<span class="kw">p_anamnese</span> <span class="op">&lt;-</span> <span class="kw">data_anamnese</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">study</span>, y = <span class="kw">dummy_smoker</span>, label = <span class="kw">anamnese_smoker</span>),
                     fontface = <span class="st">"plain"</span>,
                     position = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge2</a></span>(width = <span class="fl">1</span>),
                     show.legend = <span class="fl">FALSE</span>,
                     na.rm = <span class="fl">TRUE</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="fl">NA</span>, y = <span class="kw">dummy_smoker</span>),
                     label = <span class="st">"Smoker"</span>,
                     size = <span class="fl">5</span>,
                     fontface = <span class="st">"bold"</span>,
                     show.legend = <span class="fl">FALSE</span>,
                     na.rm = <span class="fl">TRUE</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">study</span>, y = <span class="kw">dummy_medicines</span>, label = <span class="kw">anamnese_medicines_to_control_BP</span>),
                     fontface = <span class="st">"plain"</span>,
                     position = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge2</a></span>(width = <span class="fl">1</span>),
                     show.legend = <span class="fl">FALSE</span>,
                     na.rm = <span class="fl">TRUE</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="fl">NA</span>, y = <span class="kw">dummy_medicines</span>),
                     label = <span class="st">"Medicines to\ncontrol BP"</span>,
                     size = <span class="fl">5</span>,
                     fontface = <span class="st">"bold"</span>,
                     show.legend = <span class="fl">FALSE</span>,
                     na.rm = <span class="fl">TRUE</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span>(<span class="fl">0.5</span>, <span class="fl">2.5</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span> <span class="st">"Anamnese"</span>) <span class="op">+</span>
  <span class="fu">theme_gofer</span>()

<span class="kw">p_anamnese</span>
</pre></div>
<p><img src="gofer_files/figure-html/unnamed-chunk-15-1.png" width="2400" style="display: block; margin: auto;"></p>
<div class="rmdwarning">
<p>
<br> Current GOfER state - Control layout with <code>patchwork</code>
</p>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">layout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">1</span>, b = <span class="fl">3</span>, r = <span class="fl">5</span>), <span class="co"># p_grid (the `r` argument will be adjusted as we go.. it controls the width of the plot)</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">1</span>, b = <span class="fl">3</span>, r = <span class="fl">1</span>), <span class="co"># p_studies</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">2</span>, b = <span class="fl">3</span>, r = <span class="fl">3</span>),  <span class="co"># p_sample</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">4</span>, b = <span class="fl">3</span>, r = <span class="fl">5</span>) <span class="co"># p_anamnese</span>
)

<span class="kw">p_grid</span> <span class="op">+</span>
  <span class="kw">p_studies</span> <span class="op">+</span>
  <span class="kw">p_sample</span> <span class="op">+</span>
  <span class="kw">p_anamnese</span> <span class="op">+</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span>(nrow = <span class="fl">1</span>, design = <span class="kw">layout</span>)
</pre></div>
<p><img src="gofer_files/figure-html/unnamed-chunk-17-1.png" width="3000" style="display: block; margin: auto;"></p>
<p>In panels like <strong>Anamnese</strong> you might also want to display a <strong>legend</strong> for acronyms used. You may want to explicitly tell the reader that:</p>
<div class="rmdinfo">
<p>
Y = Yes <br> N = No <br> N/R = Not Reported
</p>
</div>
<p>Therefore, the easiest way of achieving this is to create a “helper plot”, which we are going to use only its legends. Placing a legend in your GOfER is done following these steps:</p>
<ol style="list-style-type: decimal">
<li>Create the helper plot</li>
<li>When combining the plots with <code>patchwork</code>, plot the helper plot first, so it will get hidden by the others.</li>
<li>Use the <code>guides = "keep"</code> argument in <code><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">patchwork::plot_layout</a></code>.</li>
</ol>
</div>
<div id="creating-the-helper-plot" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-the-helper-plot" class="anchor"></a>5.1) Creating the helper plot</h3>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="co">## create some data</span>
<span class="kw">data_caption_label</span> <span class="op">&lt;-</span> <span class="kw">dplyr</span>::<span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(
  x = <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,
  y = <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,
  caption_label = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Y = yes"</span>, <span class="st">"N = no"</span>, <span class="st">"N/R = not reported"</span>)
) <span class="op">%&gt;%</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(caption_label = <span class="kw">forcats</span>::<span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span>(<span class="kw">caption_label</span>))
</pre></div>
<div id="basic-plot" class="section level4">
<h4 class="hasAnchor">
<a href="#basic-plot" class="anchor"></a>Basic plot</h4>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="kw">data_caption_label</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">x</span>, y = <span class="kw">y</span>, shape = <span class="kw">caption_label</span>))
</pre></div>
<p><img src="gofer_files/figure-html/unnamed-chunk-20-1.png" width="2400" style="display: block; margin: auto;"></p>
</div>
<div id="final-plot" class="section level4">
<h4 class="hasAnchor">
<a href="#final-plot" class="anchor"></a>Final plot</h4>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="kw">p_caption</span> <span class="op">&lt;-</span> <span class="kw">data_caption_label</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">x</span>, y = <span class="kw">y</span>, shape = <span class="kw">caption_label</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(xmin = <span class="op">-</span><span class="fl">Inf</span>, xmax = <span class="fl">Inf</span>, ymin = <span class="op">-</span><span class="fl">Inf</span>, ymax = <span class="fl">Inf</span>), fill = <span class="st">"white"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(shape = <span class="st">"Note:"</span>)<span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(legend.position = <span class="st">"bottom"</span>,
                 legend.direction = <span class="st">"vertical"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span>(shape = <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span>(override.aes = <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(shape=<span class="st">''</span>)))

<span class="kw">p_caption</span>
</pre></div>
<p><img src="gofer_files/figure-html/unnamed-chunk-21-1.png" width="2400" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="combine-it-with-patchwork" class="section level3">
<h3 class="hasAnchor">
<a href="#combine-it-with-patchwork" class="anchor"></a>5.2) Combine it with <code>patchwork</code>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="kw">layout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">4</span>, b = <span class="fl">3</span>, r = <span class="fl">5</span>), <span class="co"># p_caption (here you choose where to place the legend, since it is under anamnese in this example, we use `l = 4` and `r = 5`)</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">1</span>, b = <span class="fl">3</span>, r = <span class="fl">5</span>), <span class="co"># p_grid (the `r` argument will be adjusted as we go.. it controls the width of the plot)</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">1</span>, b = <span class="fl">3</span>, r = <span class="fl">1</span>), <span class="co"># p_studies</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">2</span>, b = <span class="fl">3</span>, r = <span class="fl">3</span>),  <span class="co"># p_sample</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">4</span>, b = <span class="fl">3</span>, r = <span class="fl">5</span>) <span class="co"># p_anamnese</span>
)

<span class="co">## now plot `p_caption` first</span>
<span class="kw">p_caption</span> <span class="op">+</span>
  <span class="kw">p_grid</span> <span class="op">+</span>
  <span class="kw">p_studies</span> <span class="op">+</span>
  <span class="kw">p_sample</span> <span class="op">+</span>
  <span class="kw">p_anamnese</span> <span class="op">+</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span>(nrow = <span class="fl">1</span>, design = <span class="kw">layout</span>, guides = <span class="st">"keep"</span>)
</pre></div>
<p><img src="gofer_files/figure-html/unnamed-chunk-22-1.png" width="3000" style="display: block; margin: auto;"></p>
</div>
<div id="age-panel" class="section level3">
<h3 class="hasAnchor">
<a href="#age-panel" class="anchor"></a>6) Age panel</h3>
<p>Here we plot the median from the reported <strong>age</strong> of the groups in each study.</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="co">## data preparation</span>
<span class="kw">data_age</span> <span class="op">&lt;-</span> <span class="kw">data_gofer</span> <span class="op">%&gt;%</span>
  <span class="kw">tidyr</span>::<span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest_legacy.html">unnest_legacy</a></span>() <span class="op">%&gt;%</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="kw">study</span>, <span class="kw">groups</span>, <span class="kw">age</span>) <span class="op">%&gt;%</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="kw">study</span>) <span class="op">%&gt;%</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span>(age_median = <span class="kw">stats</span>::<span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span>(<span class="kw">age</span>)) <span class="op">%&gt;%</span>
  <span class="co"># this is a hack to show a white space between the facet and the plot</span>
  <span class="co"># this is needed to be able to have subheadings</span>
  <span class="kw">dplyr</span>::<span class="fu"><a href="https://tibble.tidyverse.org/reference/add_row.html">add_row</a></span>(study = <span class="fl">NA</span>)

<span class="kw">data_age</span>
<span class="co">#&gt; # A tibble: 11 x 2</span>
<span class="co">#&gt;    study            age_median</span>
<span class="co">#&gt;    &lt;fct&gt;                 &lt;dbl&gt;</span>
<span class="co">#&gt;  1 Eguchi 2012            50.8</span>
<span class="co">#&gt;  2 Earnest 2013           48.5</span>
<span class="co">#&gt;  3 Currie 2015            64.5</span>
<span class="co">#&gt;  4 Conraads 2015          58.4</span>
<span class="co">#&gt;  5 Cocks 2013             21.5</span>
<span class="co">#&gt;  6 Ciolac 2010            25.5</span>
<span class="co">#&gt;  7 Burgomaster 2008       23.5</span>
<span class="co">#&gt;  8 Beetham 2019           61.8</span>
<span class="co">#&gt;  9 Bækkerud 2016          40  </span>
<span class="co">#&gt; 10 Abdelbasset 2020       54.6</span>
<span class="co">#&gt; 11 &lt;NA&gt;                   NA</span>
</pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="kw">p_age</span> <span class="op">&lt;-</span> <span class="kw">data_age</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">study</span>, y = <span class="kw">age_median</span>, colour = <span class="kw">age_median</span>, label = <span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="kw">age_median</span>))) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_segment.html">geom_segment</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(x = <span class="kw">study</span>, y = <span class="fl">0</span>, xend = <span class="kw">study</span>, yend = <span class="kw">age_median</span>), colour = <span class="st">"black"</span>, na.rm = <span class="fl">TRUE</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(size = <span class="fl">9</span>, na.rm = <span class="fl">TRUE</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span>(color = <span class="st">"white"</span>, size = <span class="fl">4</span>, fontface = <span class="st">"bold"</span>, na.rm = <span class="fl">TRUE</span>) <span class="op">+</span>
  <span class="co">## Hack to delete lines above</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_rect</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(xmin = <span class="kw">n_lines</span> <span class="op">-</span> <span class="fl">0.45</span>, xmax = <span class="fl">Inf</span>, ymin = <span class="op">-</span><span class="fl">Inf</span>, ymax = <span class="fl">Inf</span>), fill = <span class="st">"white"</span>, colour = <span class="st">"white"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_color_gradient</a></span>(low = <span class="st">"#3a6e7f"</span>, high = <span class="st">"#38c2a4"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span>(breaks = <span class="kw">NULL</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span>(<span class="fl">0</span>, <span class="fl">70</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(y = <span class="st">"Age (yr)"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="op">~</span> <span class="st">"Age"</span>) <span class="op">+</span>
  <span class="fu">theme_gofer</span>(strip_background = <span class="st">"#ff6581"</span>, margins = <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.1</span>), line_plot = <span class="fl">TRUE</span>)

<span class="kw">p_age</span>
</pre></div>
<p><img src="gofer_files/figure-html/unnamed-chunk-24-1.png" width="2400" style="display: block; margin: auto;"></p>
<div class="rmdwarning">
<p>
<br> Current GOfER state - Control layout with <code>patchwork</code>
</p>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit">
<span class="kw">layout</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">4</span>, b = <span class="fl">3</span>, r = <span class="fl">5</span>), <span class="co"># p_caption (here you choose where to place the legend, since it is under anamnese in this example, we use `l = 4` and `r = 5`)</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">1</span>, b = <span class="fl">3</span>, r = <span class="fl">6</span>), <span class="co"># p_grid (the `r` argument will be adjusted as we go.. it controls the width of the plot)</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">1</span>, b = <span class="fl">3</span>, r = <span class="fl">1</span>), <span class="co"># p_studies</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">2</span>, b = <span class="fl">3</span>, r = <span class="fl">3</span>), <span class="co"># p_sample</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">4</span>, b = <span class="fl">3</span>, r = <span class="fl">5</span>), <span class="co"># p_anamnese</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/area.html">area</a></span>(t = <span class="fl">1</span>, l = <span class="fl">6</span>, b = <span class="fl">3</span>, r = <span class="fl">6</span>)  <span class="co"># p _age</span>
)

<span class="kw">p_caption</span> <span class="op">+</span>
  <span class="kw">p_grid</span> <span class="op">+</span>
  <span class="kw">p_studies</span> <span class="op">+</span>
  <span class="kw">p_sample</span> <span class="op">+</span>
  <span class="kw">p_anamnese</span> <span class="op">+</span>
  <span class="kw">p_age</span> <span class="op">+</span>
  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span>(nrow = <span class="fl">1</span>, design = <span class="kw">layout</span>, guides = <span class="st">"keep"</span>)
</pre></div>
<p><img src="gofer_files/figure-html/unnamed-chunk-26-1.png" width="3000" style="display: block; margin: auto;"></p>
<hr>
</div>
<div id="final-notes" class="section level3">
<h3 class="hasAnchor">
<a href="#final-notes" class="anchor"></a>Final notes</h3>
<p>I guess by now you could have a good idea of the thought behind building a <strong>GOfER</strong> with <strong>ggplot2</strong> and <strong>patchwork</strong>. I hope this little tutorial can encourage others conducting a meta-analysis to build something similar for their own data. It certainly looks better than having this information in a table!</p>
<p>Last, but not least, I would like to express my gratitude to <strong>Will Stahl-Timmins</strong> for being such a great inspiration that led me to buillding a GOfER in R, and to <strong>Thomas Lin Pedersen</strong> and <strong>Hadley Wickham</strong> for building the fantastic <strong>patchwork</strong> and <strong>ggplot2</strong> that made this possible!</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://fmattioni.me">Felipe Mattioni Maturana</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
